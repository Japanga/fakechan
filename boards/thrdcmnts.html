<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Comments Section</title>
</head>
<body>
    <h1>Comments for Page ID: <span id="page-id-display"></span></h1>
    
    <div id="comments-container">
        <!-- Comments will be loaded here by JavaScript -->
    </div>

    <form id="comment-form">
        <textarea id="comment-input" placeholder="Add a comment..." required></textarea><br>
        <button type="submit">Post Comment</button>
    </form>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
    const commentsContainer = document.getElementById('comments-container');
    const commentForm = document.getElementById('comment-form');
    const commentInput = document.getElementById('comment-input');
    const pageIdDisplay = document.getElementById('page-id-display');

    // 1. Get the current page ID from the URL (e.g., ?id=1)
    const urlParams = new URLSearchParams(window.location.search);
    const pageId = urlParams.get('id') || 'general'; // Default to 'general' if no ID
    pageIdDisplay.textContent = pageId;
    const STORAGE_KEY = `comments_${pageId}`;

    // 2. Load comments from localStorage
    function loadComments() {
        commentsContainer.innerHTML = ''; // Clear existing comments
        const storedComments = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        
        storedComments.forEach(commentData => {
            displayComment(commentData);
        });
    }

    // 3. Display a single comment
    function displayComment(commentData) {
        const commentDiv = document.createElement('div');
        commentDiv.classList.add('comment');
        commentDiv.style.border = '1px solid #ccc';
        commentDiv.style.padding = '10px';
        commentDiv.style.marginBottom = '10px';

        commentDiv.innerHTML = `
            <p>${commentData.text}</p>
            <small>Posted on: ${new Date(commentData.date).toLocaleString()}</small>
        `;
        commentsContainer.appendChild(commentDiv);
    }

    // 4. Handle form submission and save new comments
    commentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const newCommentText = commentInput.value;
        if (!newCommentText.trim()) return;

        const commentData = {
            text: newCommentText,
            date: new Date().toISOString(), // Use ISO string for consistent storage
            id: Date.now() // Simple unique ID
        };

        // Save to localStorage
        const storedComments = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        storedComments.push(commentData);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(storedComments));

        // Display the new comment and clear the input
        displayComment(commentData);
        commentInput.value = '';
    });

    // Initial load
    loadComments();
});
  </script>
</body>
</html>
